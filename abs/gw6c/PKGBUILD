# Mantainer: Stephane Travostino <stephane.travostino@gmail.com>

pkgname=gw6c
pkgver="5.1"
pkgrel=5
pkgdesc="Client to connect to the Freenet6 IPv6 tunnel broker service"
arch=('i686' 'x86_64' 'ppc')
url="http://go6.net/"
license=(custom:MIT)
groups=(network)
depends=(openssl iproute2)
makedepends=('patch' 'gcc' 'binutils')
source=(gw6c-5_1-RELEASE-src.tar.gz compilation-fix-and-sane-defaults.patch gw6c)
md5sums=('5c5205dc58e82454a5d55a3efb4bf786'
         '0b147a67a2f523c41d55f85308291594'
         'c37b2693bdc39753e69fa158fd9f82d2')
install=gw6c.install

build() {
	cd $startdir/src/
	patch -p1 < compilation-fix-and-sane-defaults.patch || return 1

	cd $startdir/src/tspc-advanced
	make all target=linux || return 1

	mkdir -p $startdir/src/build/
	make target=linux install installdir=$startdir/src/build/ || return 1
	
	mkdir -p $startdir/pkg/usr/bin
	mkdir -p $startdir/pkg/etc/rc.d/
	mkdir -p $startdir/pkg/etc/gw6c/
	mkdir -p $startdir/pkg/etc/gw6c/template/
	mkdir -p $startdir/pkg/usr/share/man/man5/
	mkdir -p $startdir/pkg/usr/share/man/man8/
	mkdir -p $startdir/pkg/usr/share/licenses/$pkgname

	install $startdir/src/build/bin/gw6c $startdir/pkg/usr/bin/
	install $startdir/src/gw6c $startdir/pkg/etc/rc.d/
	install -m 644 $startdir/src/build/bin/gw6c.conf $startdir/pkg/etc/gw6c/
	install -m 644 $startdir/src/build/template/linux.sh $startdir/pkg/etc/gw6c/template/
	install -m 644 $startdir/src/build/man/man5/gw6c.conf.5 $startdir/pkg/usr/share/man/man5/
	install -m 644 $startdir/src/build/man/man8/gw6c.8 $startdir/pkg/usr/share/man/man8/
	install -m 644 $startdir/src/tspc-advanced/CLIENT-LICENSE.TXT $startdir/pkg/usr/share/licenses/$pkgname
}


